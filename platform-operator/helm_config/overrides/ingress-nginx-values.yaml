# Copyright (c) 2021, 2022, Oracle and/or its affiliates.
# Licensed under the Universal Permissive License v 1.0 as shown at https://oss.oracle.com/licenses/upl.

controller:
  image:
    # NOTE: The image you're looking for isn't here. The nginx-ingress-controller image now comes from
    # the bill of materials file (verrazzano-bom.json).
    digest:
  config:
    client-body-buffer-size: 64k
    proxy-buffer-size: 8k
    custom-http-errors: 301,304,307,308,401,403,404,407,408,409,413,414,415,416,418,421,429,431,500,501,502,503,504,505
  metrics:
    enabled: true
  publishService:
    enabled: true
  service:
    enableHttp: false
  admissionWebhooks:
    enabled: false
  podAnnotations:
    prometheus.io/port: "10254"
    prometheus.io/scrape: "true"
    system.io/scrape: "true"
    traffic.sidecar.istio.io/excludeInboundPorts: "80,443"
    traffic.sidecar.istio.io/includeInboundPorts: ""
    sidecar.istio.io/rewriteAppHTTPProbers: "true"
  volumeMounts:
    - mountPath: /etc/nginx/template
      name: nginx-template
      readOnly: true
    - mountPath: /usr/local/nginx/html
      name: custom-400-error
  volumes:
    - name: nginx-template
      configMap:
        name: ingress-controller-ingress-nginx-controller-template
        items:
          - key: nginx.tmpl
            path: nginx.tmpl
    - name: custom-400-error
      configMap:
        name: ingress-controller-ingress-nginx-controller-template
        items:
          - key: 400.html
            path: 400.html
defaultBackend:
  # NOTE: The image you're looking for isn't here. The nginx-ingress-default-backend image now comes from
  # the bill of materials file (verrazzano-bom.json).
  enabled: true

  podAnnotations:
    traffic.sidecar.istio.io/excludeInboundPorts: "8080"

  extraVolumeMounts:
    - name: error-pages
      mountPath: /www

  extraVolumes:
    - name: error-pages
      configMap:
        name: ingress-controller-ingress-nginx-defaultbackend-custom-error-pages
        items:
          - key: 301.html
            path: 301.html
          - key: 302.html
            path: 302.html
          - key: 304.html
            path: 304.html
          - key: 307.html
            path: 307.html
          - key: 308.html
            path: 308.html
          - key: 400.html
            path: 400.html
          - key: 401.html
            path: 401.html
          - key: 403.html
            path: 403.html
          - key: 404.html
            path: 404.html
          - key: 407.html
            path: 407.html
          - key: 408.html
            path: 408.html
          - key: 409.html
            path: 409.html
          - key: 413.html
            path: 413.html
          - key: 414.html
            path: 414.html
          - key: 415.html
            path: 415.html
          - key: 416.html
            path: 416.html
          - key: 418.html
            path: 418.html
          - key: 421.html
            path: 421.html
          - key: 429.html
            path: 429.html
          - key: 431.html
            path: 431.html
          - key: 500.html
            path: 500.html
          - key: 501.html
            path: 501.html
          - key: 502.html
            path: 502.html
          - key: 503.html
            path: 503.html
          - key: 504.html
            path: 504.html
          - key: 505.html
            path: 505.html
          - key: 301.html
            path: 301.htm
          - key: 302.html
            path: 302.htm
          - key: 304.html
            path: 304.htm
          - key: 307.html
            path: 307.htm
          - key: 308.html
            path: 308.htm
          - key: 400.html
            path: 400.htm
          - key: 401.html
            path: 401.htm
          - key: 403.html
            path: 403.htm
          - key: 404.html
            path: 404.htm
          - key: 407.html
            path: 407.htm
          - key: 408.html
            path: 408.htm
          - key: 409.html
            path: 409.htm
          - key: 413.html
            path: 413.htm
          - key: 414.html
            path: 414.htm
          - key: 415.html
            path: 415.htm
          - key: 416.html
            path: 416.htm
          - key: 418.html
            path: 418.htm
          - key: 421.html
            path: 421.htm
          - key: 429.html
            path: 429.htm
          - key: 431.html
            path: 431.htm
          - key: 500.html
            path: 500.htm
          - key: 501.html
            path: 501.htm
          - key: 502.html
            path: 502.htm
          - key: 503.html
            path: 503.htm
          - key: 504.html
            path: 504.htm
          - key: 505.html
            path: 505.htm
          - key: 301.html
            path: 301.json
          - key: 302.html
            path: 302.json
          - key: 304.html
            path: 304.json
          - key: 307.html
            path: 307.json
          - key: 308.html
            path: 308.json
          - key: 400.html
            path: 400.json
          - key: 401.html
            path: 401.json
          - key: 403.html
            path: 403.json
          - key: 404.html
            path: 404.json
          - key: 407.html
            path: 407.json
          - key: 408.html
            path: 408.json
          - key: 409.html
            path: 409.json
          - key: 413.html
            path: 413.json
          - key: 414.html
            path: 414.json
          - key: 415.html
            path: 415.json
          - key: 416.html
            path: 416.json
          - key: 418.html
            path: 418.json
          - key: 421.html
            path: 421.json
          - key: 429.html
            path: 429.json
          - key: 431.html
            path: 431.json
          - key: 500.html
            path: 500.json
          - key: 501.html
            path: 501.json
          - key: 502.html
            path: 502.json
          - key: 503.html
            path: 503.json
          - key: 504.html
            path: 504.json
          - key: 505.html
            path: 505.json

apiVersion: batch/v1
kind: Job
metadata:
  labels:
    job-name: verrazzano-images-cluster1
  name: verrazzano-images-cluster1
  namespace: verrazzano-system
spec:
  selector:
    matchLabels:
      job-name: verrazzano-images-cluster1
  template:
    metadata:
      labels:
        job-name: verrazzano-images-cluster1
      name: verrazzano-images-cluster1
      namespace: verrazzano-system
    spec:
      containers:
      - env:
        - name: IMAGE_NAME
          value: test-build
        - name: IMAGE_TAG
          value: dev-2
        - name: IMAGE_REGISTRY
          value: phx.ocir.io
        - name: IMAGE_TENANCY
          value: stevengreenberginc
        - name: IMAGE_REPOSITORY
          value: marco/wit-build
        - name: BASE_IMAGE
          value: ghcr.io/oracle/oraclelinux:8-slim
        - name: JDK_INSTALLER_BINARY
          value: jdk-8u281-linux-x64.tar.gz
        - name: JDK_INSTALLER_VERSION
          value: 8u281
        - name: WEBLOGIC_INSTALLER_BINARY
          value: fmw_12.2.1.4.0_wls.jar
        - name: WEBLOGIC_INSTALLER_VERSION
          value: 12.2.1.4.0
        - name: WDT_INSTALLER_BINARY
          value: weblogic-deploy.zip
        image: wit:4
        imagePullPolicy: IfNotPresent
        name: image-build-request
        securityContext:
          allowPrivilegeEscalation: true
          privileged: false
          readOnlyRootFilesystem: false
        volumeMounts:
        - name: registry-creds
          mountPath: "/registry-creds"
          readOnly: true
      volumes:
      - name: registry-creds
        secret:
          secretName: verrazzano-imagetool
      restartPolicy: Never
      serviceAccount: verrazzano-image-build-job
      serviceAccountName: verrazzano-image-build-job
